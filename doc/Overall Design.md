## 书店管理系统（Bookstore）总体设计文档

赵也品

## 程序功能概述

该项目设计并实现了一个书店管理系统，使用命令行进行操作。为店主、员工和顾客提供不同级别的图书管理、交易和查询服务。系统实现了账户系统、图书系统和日志系统，满足不同用户的操作需求。

主要功能模块：

**账户系统：** 用户注册、登录、权限管理、密码修改、删除账户等功能

**图书系统：** 图书检索、购买、修改、进货等操作

**日志系统：** 财务记录查询、操作日志、报告生成等功能

## 代码文件结构

`main.cpp`：

主程序入口。

`bookstore.cpp`:

用于控制操作。

实现了以下功能（账户相关）：登录帐户、注销帐户、注册帐户、修改密码、创建帐户、删除帐户。

实现了以下功能（图书相关）：检索图书、购买图书、选择图书、修改图书信息、图书进货。

实现了以下功能（日志相关）：财务记录查询、生成财务记录报告、生成日志。

`command.cpp`:
实现了一个指令类，用于指令处理。

`account.cpp`：

实现了一个账户类，用于管理用户信息，包含：账号、密码、用户名、类型等。

`book.cpp`：

实现了一个图书类，用于管理图书信息，包含：ISBN 号、书名、作者、关键字、库存量、单价等。

`utils.cpp`:
实现了一些工具函数，用于检查指令是否合法，以及验证中文输入。

`log.cpp`：

实现了一个日志类，用于管理业务信息，包含：操作者、操作类型、具体操作参数等。

`BlockLinkedList.cpp`：

基于文件存储实现一个 key-value database（键值数据库），采用块状链表进行实现。

`MemoryRiver.hpp`： 

实现一个文件读写类，是为了方便对文件的操作而封装了一些操作。该类的功能有：

- 与一个文件名（string）绑定
- 往文件中写入一个 `int` 或 `T` 类型对象
- 往文件中读取一个 `int` 或 `T` 类型对象

## 功能设计

1. 账户系统：
- 用户注册、登录、注销
- 密码修改
- 权限等级管理
- 登录栈维护
- 创建、删除账户

2. 图书系统：
- 图书信息的增删改查
- 多条件检索（ISBN/书名/作者/关键词）
- 库存管理
- 图书选择状态维护

3. 日志系统：
- 交易记录存储与查询
- 财务报表生成
- 操作日志记录
- 员工工作报告

## 数据库设计

- 用户信息文件，使用 `MemoryRiver` 存储账户类，具体存储位置被随后文件记录。

- 用户存储位置文件，使用 `BlockLinkedList` 存储账户类，以账号为关键字排序。

- 图书信息文件，使用 `MemoryRiver` 存储图书类，具体存储位置被随后 4 个文件记录。

- 图书存储位置文件（4个）：使用 `BlockLinkedList` 记录每个图书在 `MemoryRiver` 中存储的位置，分别以ISBN 号、书名、作者和关键字为关键字排序。

- 财务记录文件：使用 `MemoryRiver` 存储每一条操作的收入和支出。

- 日志文件：使用 `MemoryRiver` 存储业务信息。

# 类、结构体设计

1. 账户类（Account）:

存储以下信息：`userID`、`password`、`username`、`privilege`。

2. 图书类（Book）:

存储以下信息：`ISBN`、`bookName`、`author`、`keyword`、`price`、`stock`。

3. 日志类（Log）：

存储以下信息：`UserID`、`operator`、`income`、`expenditure`、`quantity`、`Account`、`Book`。

4. 指令类（Command）:

实现以下函数：`read()`、`getstr()`

5. 书店类（Bookstore）:

存储以下信息：所有的文件、指令、登陆栈

实现以下函数（账户相关）：`su()`、`logout()`、`register()`、`passwd()`、`useradd()`、`delete()`。

实现以下函数（图书相关）：`show()`、`buy()`、`select()`、`modify()`、`import()`。

实现以下函数（日志相关）：`show()`、`ReportFinance()`、`ReportEmployee()`。

# 其他补充说明

无